<?xml version="1.0"?>
<Benchmark xmlns="http://checklists.nist.gov/xccdf/1.1" xmlns:xhtml="http://www.w3.org/1999/xhtml" id="xccdf_org.open-scap.sce-community-content_benchmark_sectool_checks" xml:lang="en">
  <status date="2012-02-06">draft</status>
  <title>Migrated sectool checks</title>
  <description>These checks are originally from sectool (http://fedorahosted.org/sectool) and have been migrated to SCE for use with XCCDF and related technologies.</description>
  <notice id="disclaimer">This XCCDF has been automatically generated, it should only serve as a baseline!</notice>
  <reference href="http://open-scap.org/page/SCE"/>
  <reference href="http://open-scap.org/page/SCE_result_file"/>
  <reference href="http://fedorahosted.org/sectool"/>
  <platform idref="cpe:/o:redhat:enterprise_linux:6"/>
  <version>0.1</version>
  <model system="urn:xccdf:scoring:flat" />

  <Profile id="Fedora-default">
    <title>Fedora default</title>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_sectool-12" selected="false" /> <!-- host based ssh auth requires permissions that fail this test -->
  </Profile>

  <Group id="xccdf_org.open-scap.sce-community-content_group_sectool" hidden="false">
    <title>Sectool</title>

    <Value id="xccdf_org.open-scap.sce-community-content_value_sectool_selinux_state" type="string" operator="equals">
      <title>sectool: SELinux state</title>
      <description xml:lang="en"> 
enforcing - SELinux security policy is enforced. <xhtml:br />
permissive - SELinux prints warnings instead of enforcing.<xhtml:br />
disabled - SELinux is fully disabled.
      </description>
      <question xml:lang="en">Set the SELinux state</question>
      <value>enforcing</value>
      <value selector="enforcing">enforcing</value>
      <value selector="permissive">permissive</value>
      <value selector="disabled">disabled</value>
      <match>enforcing|permissive|disabled</match>
      <choices mustMatch="1">
        <choice>enforcing</choice>
        <choice>permissive</choice>
        <choice>disabled</choice>
      </choices>
    </Value>

    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-1" selected="true">
      <title>sectool: integrity</title>
      <description>
        <xhtml:p>System integrity test. Checks presence and integrity of system commands and directories. For checking the integrity of binaries the command rpmverify (rpm -Vf) is used. A search for duplicates is also done for each command.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/00_integrity.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-2" selected="true">
      <title>sectool: bootloader</title>
      <description>
        <xhtml:p>Tests</xhtml:p>
        <xhtml:ul>
          <xhtml:li>permission and owner of /etc/grub.conf</xhtml:li>
          <xhtml:li>password presence</xhtml:li>
        </xhtml:ul>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/01_bootloader.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-3" selected="true">
      <title>sectool: disk_usage</title>
      <description>
        <xhtml:p>Tells user, which of mounted volumes are going to be full. Uses df to get this info.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/01_disk_usage.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-4" selected="true">
      <title>sectool: group</title>
      <description>
        <xhtml:p>Checks group for whether</xhtml:p>
        <xhtml:ul>
          <xhtml:li>line is not blank</xhtml:li>
          <xhtml:li>line has correct number of fields</xhtml:li>
          <xhtml:li>groupname is not empty</xhtml:li>
          <xhtml:li>groupname contains only alpha-numeric characters</xhtml:li>
          <xhtml:li>groupname is shorter than 32 chars</xhtml:li>
          <xhtml:li>all group passwords are shadowed</xhtml:li>
          <xhtml:li>GIDs are valid numbers</xhtml:li>
          <xhtml:li>GIDs are in range 0..60000</xhtml:li>
          <xhtml:li>there are groups with same GID</xhtml:li>
          <xhtml:li>there are same groupnames</xhtml:li>
        </xhtml:ul>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/01_group.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-5" selected="true">
      <title>sectool: passwd</title>
      <description>
        <xhtml:p>Checks passwd for whether</xhtml:p>
        <xhtml:ul>
          <xhtml:li>/etc/passwd has permission 644 and its owner is root:root</xhtml:li>
          <xhtml:li>/etc/shadow has permission 400 and its owner is root:root</xhtml:li>
          <xhtml:li>line is not blank</xhtml:li>
          <xhtml:li>line has correct number of fields</xhtml:li>
          <xhtml:li>username is not empty</xhtml:li>
          <xhtml:li>username contains only alpha-numeric characters</xhtml:li>
          <xhtml:li>username is shorter than 32 chars</xhtml:li>
          <xhtml:li>all users have password</xhtml:li>
          <xhtml:li>all passwords are shadowed</xhtml:li>
          <xhtml:li>UID and GID are valid numbers</xhtml:li>
          <xhtml:li>UID and GID are in range 500..60000</xhtml:li>
          <xhtml:li>user has UID 0, but his username is not root</xhtml:li>
          <xhtml:li>user has UID 1, but his username is not bin</xhtml:li>
          <xhtml:li>user has GID 0, but his username is not root</xhtml:li>
          <xhtml:li>user has GID 1, but his username is not bin</xhtml:li>
          <xhtml:li>user has negative UID</xhtml:li>
          <xhtml:li>user has negative GID</xhtml:li>
          <xhtml:li>there are users with same UID</xhtml:li>
          <xhtml:li>there are same username</xhtml:li>
          <xhtml:li>root has UID 0</xhtml:li>
          <xhtml:li>user has valid shell (listed in /etc/shells)</xhtml:li>
        </xhtml:ul>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/01_passwd.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-6" selected="true">
      <title>sectool: shadow</title>
      <description>
        <xhtml:p>Checks shadow for whether</xhtml:p>
        <xhtml:ul>
          <xhtml:li>/etc/shadow has permission 400 and its owner is root:root</xhtml:li>
          <xhtml:li>line is not blank</xhtml:li>
          <xhtml:li>line has correct number of fields</xhtml:li>
          <xhtml:li>username is not empty</xhtml:li>
          <xhtml:li>username contains only alpha-numeric characters</xhtml:li>
          <xhtml:li>username is shorter than 32 chars</xhtml:li>
          <xhtml:li>all users have password</xhtml:li>
          <xhtml:li>there are same usernames</xhtml:li>
        </xhtml:ul>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/01_shadow.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-7" selected="true">
      <title>sectool: home_files</title>
      <description>
        <xhtml:p>Tests ownership and access rights to sensitive files (.bashrc, ssh/id_dsa etc.) in home directories of all users</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/02_home_files.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-8" selected="true">
      <title>sectool: root_dirs</title>
      <description>
        <xhtml:p>Do not allow dot directories in "/"</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/02_root_dirs.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-9" selected="true">
      <title>sectool: path</title>
      <description>
        <xhtml:p>Checks</xhtml:p>
        <xhtml:ul>
          <xhtml:li>if all directories listed in PATH exist</xhtml:li>
        </xhtml:ul>
        <xhtml:p>Tests environmental variable PATH for</xhtml:p>
        <xhtml:ul>
          <xhtml:li>hazardous paths curent directiory, relative path, '/tmp'</xhtml:li>
          <xhtml:li>group-writable or world-writable directories</xhtml:li>
          <xhtml:li>writable executables</xhtml:li>
        </xhtml:ul>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/03_path.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-10" selected="true">
      <title>sectool: firewall</title>
      <description>
        <xhtml:p>Simple analysis of firewall policy rules.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/04_firewall.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-11" selected="true">
      <title>sectool: netserv</title>
      <description>
        <xhtml:p>Audit of currently running network services.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/05_netserv.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-12" selected="true">
      <title>sectool: openssh</title>
      <description>
        <xhtml:p>OpenSSH configuration audit.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/05_openssh.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-13" selected="true">
      <title>sectool: openvpn</title>
      <description>
        <xhtml:p>OpenVPN configuration audit.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/05_openvpn.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-14" selected="true">
      <title>sectool: removed_libs</title>
      <description>
        <xhtml:p>Checks if libraries mapped into memory are the same as the libraries on the disk. To get rid of this warnings simply restart these processes (their names and PIDs are in messages printed out by this test). Use the command service(8) to restart processes that belong to a running system service.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/05_removed_libs.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-15" selected="true">
      <title>sectool: xinetd</title>
      <description>
        <xhtml:p>xinetd configuration audit.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/05_xinetd.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-16" selected="true">
      <title>sectool: log_files</title>
      <description>
        <xhtml:p>Tests logfiles presence, owner, group and permissions of logfiles.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/07_log_files.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-17" selected="true">
      <title>sectool: pam</title>
      <description>
        <xhtml:p>PAM configuration audit.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/08_pam.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-18" selected="true">
      <title>sectool: permissions</title>
      <description>
        <xhtml:p>Tests important directories for presence, permissions and owner.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/08_permissions.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-19" selected="true">
      <title>sectool: exec_shield</title>
      <description>
        <xhtml:p>Checks if exec-shield is enabled.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/09_exec_shield.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-20" selected="true">
      <title>sectool: selinux</title>
      <description>
        <xhtml:p>Checks the SELinux state, result depends on passed variable. By default checks whether SELinux is enabled and in enforcing mode.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-export value-id="xccdf_org.open-scap.sce-community-content_value_sectool_selinux_state" export-name="EXPECTED_STATE"/>
        <check-content-ref href="sectool/09_selinux.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-21" selected="true">
      <title>sectool: va_randomization</title>
      <description>
        <xhtml:p>Checks whether va-randomization is enabled.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/09_va_randomization.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-22" selected="true">
      <title>sectool: aliases</title>
      <description>
        <xhtml:p>Checks bash aliases for:</xhtml:p>
        <xhtml:ul>
          <xhtml:li>existence of included file</xhtml:li>
          <xhtml:li>existence of command</xhtml:li>
          <xhtml:li>possibility of changing content of file implementing the command (world/other writable, owner not root)</xhtml:li>
          <xhtml:li>possibility of changing content of included file (world/other writable, owner not root)</xhtml:li>
        </xhtml:ul>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/11_aliases.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-23" selected="true">
      <title>sectool: cron</title>
      <description>
        <xhtml:p>Basic crontab checking.</xhtml:p>
        <xhtml:p>Looks for unexpected paths in the crontab PATH variable, checks ownership and permissions of cron related dirs and commands listed in crontab.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/12_cron.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-24" selected="true">
      <title>sectool: nfs</title>
      <description>
        <xhtml:p>Audit of nfs server. Finds RW exports</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/14_nfs.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_sectool-25" selected="true">
      <title>sectool: tcp_wrappers</title>
      <description>
        <xhtml:p>Checks whether all running applications, which are using libwrap, have some restrictions in /etc/hosts.deny and /etc.hosts allow</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="sectool/15_tcp_wrappers.sh"/>
      </check>
    </Rule>
  </Group>
</Benchmark>

