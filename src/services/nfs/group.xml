<xf:xccdf-fragment xmlns:xf="http://fedorahosted.org/sce-community-content/wiki/XCCDF-fragment" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml">
  <Group id="xccdf_org.open-scap.sce-community-content_group_services_nfs" selected="true">
    <title>NFS service security controls</title>

    <Rule id="xccdf_org.open-scap.sce-community-content_rule_services_nfs-nfs" selected="true">
      <title>Check if NFS exports are set properly</title>
      <description>
        <xhtml:p>The machine must not be write-accessable through NFS.</xhtml:p>
        <xhtml:p>Enabling write access through NFS may compromise the integrity of the system.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/exports</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <fix system="urn:xccdf:fix:script:sh"><![CDATA[
        EXPORTS="/etc/exports"
        
        if [ ! -e $EXPORTS ]
        then
          touch $EXPORTS
          chmod 0644 $EXPORTS
          exit 0
        fi
        
        if [ ! -f $EXPORTS ]
        then
          echo "$EXPORTS not a file"
          exit 1
        fi
        
        TEMPFILE=$(mktemp)
        sed -e 's|\([(,]\)rw\([),]\)|\1ro\2|g' < $EXPORTS > $TEMPFILE
        mv $TEMPFILE $EXPORTS
        chmod 0644 $EXPORTS
      ]]></fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="14_nfs.sh"/>
      </check>
    </Rule> 
  </Group>
</xf:xccdf-fragment>
