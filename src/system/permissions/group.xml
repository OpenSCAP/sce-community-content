<xf:xccdf-fragment xmlns:xf="http://fedorahosted.org/sce-community-content/wiki/XCCDF-fragment" xmlns="http://checklists.nist.gov/xccdf/1.1" xmlns:xhtml="http://www.w3.org/1999/xhtml">
  <Group id="xccdf_org.open-scap.sce-community-content_group_system_permissions" selected="true">
    <title>Permissions</title>

    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_permissions-group" selected="true">
      <title>group</title>
      <description>
        <xhtml:p>Checks group for whether</xhtml:p>
        <xhtml:ul>
          <xhtml:li>line is not blank</xhtml:li>
          <xhtml:li>line has correct number of fields</xhtml:li>
          <xhtml:li>groupname is not empty</xhtml:li>
          <xhtml:li>groupname contains only alpha-numeric characters</xhtml:li>
          <xhtml:li>groupname is shorter than 32 chars</xhtml:li>
          <xhtml:li>all group passwords are shadowed</xhtml:li>
          <xhtml:li>GIDs are valid numbers</xhtml:li>
          <xhtml:li>GIDs are in range 0..60000</xhtml:li>
          <xhtml:li>there are groups with same GID</xhtml:li>
          <xhtml:li>there are same groupnames</xhtml:li>
        </xhtml:ul>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="01_group.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_permissions-passwd" selected="true">
      <title>passwd</title>
      <description>
        <xhtml:p>Checks passwd for whether</xhtml:p>
        <xhtml:ul>
          <xhtml:li>/etc/passwd has permission 644 and its owner is root:root</xhtml:li>
          <xhtml:li>/etc/shadow has permission 400 and its owner is root:root</xhtml:li>
          <xhtml:li>line is not blank</xhtml:li>
          <xhtml:li>line has correct number of fields</xhtml:li>
          <xhtml:li>username is not empty</xhtml:li>
          <xhtml:li>username contains only alpha-numeric characters</xhtml:li>
          <xhtml:li>username is shorter than 32 chars</xhtml:li>
          <xhtml:li>all users have password</xhtml:li>
          <xhtml:li>all passwords are shadowed</xhtml:li>
          <xhtml:li>UID and GID are valid numbers</xhtml:li>
          <xhtml:li>UID and GID are in range 500..60000</xhtml:li>
          <xhtml:li>user has UID 0, but his username is not root</xhtml:li>
          <xhtml:li>user has UID 1, but his username is not bin</xhtml:li>
          <xhtml:li>user has GID 0, but his username is not root</xhtml:li>
          <xhtml:li>user has GID 1, but his username is not bin</xhtml:li>
          <xhtml:li>user has negative UID</xhtml:li>
          <xhtml:li>user has negative GID</xhtml:li>
          <xhtml:li>there are users with same UID</xhtml:li>
          <xhtml:li>there are same username</xhtml:li>
          <xhtml:li>root has UID 0</xhtml:li>
          <xhtml:li>user has valid shell (listed in /etc/shells)</xhtml:li>
        </xhtml:ul>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="01_passwd.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_permissions-shadow" selected="true">
      <title>shadow</title>
      <description>
        <xhtml:p>Checks shadow for whether</xhtml:p>
        <xhtml:ul>
          <xhtml:li>/etc/shadow has permission 400 and its owner is root:root</xhtml:li>
          <xhtml:li>line is not blank</xhtml:li>
          <xhtml:li>line has correct number of fields</xhtml:li>
          <xhtml:li>username is not empty</xhtml:li>
          <xhtml:li>username contains only alpha-numeric characters</xhtml:li>
          <xhtml:li>username is shorter than 32 chars</xhtml:li>
          <xhtml:li>all users have password</xhtml:li>
          <xhtml:li>there are same usernames</xhtml:li>
        </xhtml:ul>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="01_shadow.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_permissions-pam" selected="true">
      <title>pam</title>
      <description>
        <xhtml:p>PAM configuration audit.</xhtml:p>
      </description>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="08_pam.sh"/>
      </check>
    </Rule>
  </Group>
</xf:xccdf-fragment>

