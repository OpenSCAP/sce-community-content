<xf:xccdf-fragment xmlns:xf="http://fedorahosted.org/sce-community-content/wiki/XCCDF-fragment" xmlns="http://checklists.nist.gov/xccdf/1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml">
  <Profile id="xccdf_org.open-scap.sce-community-content_profile_fedora-default">
    <refine-value idref="xccdf_org.open-scap.sce-community-content_value_system_file_permissions-system_logs_permissions-allow_world_readable" selector="yes"/>
  </Profile>

  <Profile id="xccdf_org.open-scap.sce-community-content_profile_stig">
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-root_home_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-network_daemon_files" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_files" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_dirs_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_dirs_group" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_logs_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-man_pages_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-library_files_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-passwd_file_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-shadow_file_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-shadow_file_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-home_dirs_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-home_dirs_files_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-etc_rc_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-skeleton_files_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-etc_shell_files_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-etc_shell_files_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-world_writable_dirs_sticky" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-world_writable_dirs_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-audit_logs_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-audit_logs_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-cron_allow_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-crontab_files_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-cron_dirs_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-cron_dirs_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-cron_dirs_group" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-xinetd_dirs_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-xinetd_files_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-services_file_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-services_file_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-alias_file_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-alias_file_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-smb_conf_permissions" selected="true"/>
  </Profile>

  <Profile id="xccdf_org.open-scap.sce-community-content_profile_pci-dss">
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_files_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_files_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_dirs_owner" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_dirs_group" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_files_permissions" selected="true"/>
    <select idref="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_files_permissions" selected="true"/>
  </Profile>

  <Group id="xccdf_org.open-scap.sce-community-content_group_system_file_permissions" selected="true">
    <title>File permissions</title>

    <Value id="xccdf_org.open-scap.sce-community-content_value_system_file_permissions-system_logs_permissions-allow_world_readable" type="boolean" operator="equals">
      <title>Allow world readable logs</title>
      <description xml:lang="en">
        World readable logs are never allowed in strict hardened configurations but are common on desktops.
      </description>
      <question xml:lang="en">Are world readable logs allowed?</question>
     
      <value>0</value>
      <value selector="yes">1</value>
      <value selector="no">0</value>
    </Value>

    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-home_files" selected="true">
      <title>home files</title>
      <description>
        <xhtml:p>Tests ownership and access rights to sensitive files (.bashrc, ssh/id_dsa etc.) in home directories of all users</xhtml:p>
      </description>
      <fix system="urn:xccdf:fix:script:sh"><![CDATA[
        for user in $(grep -v /sbin/nologin /etc/passwd | cut -d: -f 6)
        do
          chmod go-rwx $user/.netrc 2>/dev/null
          chmod go-rwx $user/.rhosts 2>/dev/null
          chmod go-rwx $user/.shosts 2>/dev/null
          chmod go-rwx $user/.Xauthority 2>/dev/null
          chmod go-rwx $user/.gnupg/secring.gpg 2>/dev/null
          chmod go-rwx $user/.pgp/secring.pgp 2>/dev/null
          chmod go-rwx $user/.ssh/identity 2>/dev/null
          chmod go-rwx $user/.ssh/id_dsa 2>/dev/null
          chmod go-rwx $user/.ssh/id_rsa 2>/dev/null
          chmod go-rwx $user/.ssh/random_seed 2>/dev/null
          chmod go-rwx $user/.pgp/randseed.bin 2>/dev/null

          chmod go-w $user/.bashrc 2>/dev/null
          chmod go-w $user/.bash_profile 2>/dev/null
          chmod go-w $user/.bash_login 2>/dev/null
          chmod go-w $user/.bash_logout 2>/dev/null
          chmod go-w $user/.cshrc 2>/dev/null
          chmod go-w $user/.emacs 2>/dev/null
          chmod go-w $user/.exrc 2>/dev/null
          chmod go-w $user/.forward 2>/dev/null
          chmod go-w $user/.gdbrc 2>/dev/null
          chmod go-w $user/.klogin 2>/dev/null
          chmod go-w $user/.login 2>/dev/null
          chmod go-w $user/.logout 2>/dev/null
          chmod go-w $user/.profile 2>/dev/null
          chmod go-w $user/.tcshrc 2>/dev/null
          chmod go-w $user/.fvwmrc 2>/dev/null
          chmod go-w $user/.inputrc 2>/dev/null
          chmod go-w $user/.kshrc 2>/dev/null
          chmod go-w $user/.nexrc 2>/dev/null
          chmod go-w $user/.screenrc 2>/dev/null
          chmod go-w $user/.ssh 2>/dev/null
          chmod go-w $user/.ssh/config 2>/dev/null
          chmod go-w $user/.ssh/authorized_keys 2>/dev/null
          chmod go-w $user/.ssh/environment 2>/dev/null
          chmod go-w $user/.ssh/known_hosts 2>/dev/null
          chmod go-w $user/.ssh/rc 2>/dev/null
          chmod go-w $user/.twmrc 2>/dev/null
          chmod go-w $user/.vimrc 2>/dev/null
          chmod go-w $user/.viminfo 2>/dev/null
          chmod go-w $user/.xsession 2>/dev/null
          chmod go-w $user/.xinitrc 2>/dev/null
          chmod go-w $user/.Xdefaults 2>/dev/null
          chmod go-w $user/.zshenv 2>/dev/null
          chmod go-w $user/.zprofile 2>/dev/null
          chmod go-w $user/.zshrc 2>/dev/null
          chmod go-w $user/.zlogin 2>/dev/null
          chmod go-w $user/.zlogout 2>/dev/null
        done
      ]]></fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="02_home_files.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-permissions" selected="true">
      <title>permissions</title>
      <description>
        <xhtml:p>Tests important directories for presence, permissions and owner.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/</xhtml:li>
            <xhtml:li>/bin</xhtml:li>
            <xhtml:li>/boot</xhtml:li>
            <xhtml:li>/dev</xhtml:li>
            <xhtml:li>/etc</xhtml:li>
            <xhtml:li>/home</xhtml:li>
            <xhtml:li>/lib</xhtml:li>
            <xhtml:li>/media</xhtml:li>
            <xhtml:li>/mnt</xhtml:li>
            <xhtml:li>/opt</xhtml:li>
            <xhtml:li>/root</xhtml:li>
            <xhtml:li>/sbin</xhtml:li>
            <xhtml:li>/srv</xhtml:li>
            <xhtml:li>/usr</xhtml:li>
            <xhtml:li>/usr/bin</xhtml:li>
            <xhtml:li>/usr/sbin</xhtml:li>
            <xhtml:li>/usr/include</xhtml:li>
            <xhtml:li>/usr/lib</xhtml:li>
            <xhtml:li>/usr/share</xhtml:li>
            <xhtml:li>/usr/src</xhtml:li>
            <xhtml:li>/usr/local</xhtml:li>
            <xhtml:li>/var</xhtml:li>
            <xhtml:li>/var/lock</xhtml:li>
            <xhtml:li>/var/log</xhtml:li>
            <xhtml:li>/var/run</xhtml:li>
            <xhtml:li>/var/spool</xhtml:li>
            <xhtml:li>/var/spool/mail</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <fix system="urn:xccdf:fix:script:sh"><![CDATA[
        function fix
        {
          [ ! -d $1 ] && mkdir -p $1
          chown root $1
          expected_permission=$(printf 0%o $[0777 & ~0$perm_mask])
          chmod $expected_permission $dir
        }
        
        # list of pairs - absolute path of the directory and a permission mask
        fix / 222
        fix /bin 222
        fix /boot 222
        fix /dev 022
        fix /etc 022
        fix /home 022
        fix /lib 222
        fix /media 022
        fix /mnt 022
        fix /opt 022
        fix /root 227
        fix /sbin 222
        fix /srv 022
        fix /usr 022
        fix /usr/bin 222
        fix /usr/sbin 222
        fix /usr/include 022
        fix /usr/lib 222
        fix /usr/share 022
        fix /usr/src 022
        fix /usr/local 022
        fix /var 022
        fix /var/lock 002
        fix /var/log 022
        fix /var/run 022
        fix /var/spool 022
        fix /var/spool/mail 002
      ]]></fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="08_permissions.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-root_home_permissions" selected="true">
      <title>/root permissions</title>
      <description>
        <xhtml:p>/root should be 0750 or less.</xhtml:p>
        <xhtml:p>Permissions greater than 0700 could allow unauthorized users access to the root home directory.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/root</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN000920</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chmod g-w,o-rwx /root
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN000920.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-network_daemon_files" selected="true">
      <title>network daemon files</title>
      <description>
        <xhtml:p>Network service daemon files should be 0755 or less.</xhtml:p>
        <xhtml:p>Restricting permission on daemons will protect them from unauthorized modification and possible system compromise.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/sysconfig/network-scripts/*</xhtml:li>
            <xhtml:li>/etc/sysconfig/networking</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001180</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /etc/sysconfig/network-scripts -type f -perm /0022 -exec chmod 0755 {} \;
        [ -d /etc/sysconfig/networking ] &amp;&amp; find /etc/sysconfig/networking -type f -perm /0022 -perm /0022 -exec chmod 0755 {} \;
        exit 0
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001180.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_files_permissions" selected="true">
      <title>system command files - permissions</title>
      <description>
        <xhtml:p>System command files must be 0755 or less.</xhtml:p>
        <xhtml:p>Restricting permissions will protect system command files from unauthorized modification. System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/bin</xhtml:li>
            <xhtml:li>/sbin</xhtml:li>
            <xhtml:li>/usr/bin</xhtml:li>
            <xhtml:li>/usr/sbin</xhtml:li>
            <xhtml:li>/usr/local/bin</xhtml:li>
            <xhtml:li>/usr/local/sbin</xhtml:li>
            <xhtml:li>/usr/lib64/qt-3.3/bin</xhtml:li>
            <xhtml:li>/usr/java/j2re1.4.2_06/bin</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001200</ident>
      <ident system="https://www.pcisecuritystandards.org">PCIDSS-A.1.2.c</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /bin -type f -perm /0022 -exec chmod go-w {} \;
        find /sbin -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/bin -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/sbin -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/local/bin -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/local/sbin -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/lib64/qt-3.3/bin -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/java/j2re1.4.2_06/bin -type f -perm /0022 -exec chmod go-w {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001200.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_files_owner" selected="true">
      <title>system command files - owners</title>
      <description>
        <xhtml:p>System command files must be owned by root.</xhtml:p>
        <xhtml:p>Allowing commands to be owned by non-root users may enable users to change the meaning of system commands.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/bin</xhtml:li>
            <xhtml:li>/sbin</xhtml:li>
            <xhtml:li>/usr/bin</xhtml:li>
            <xhtml:li>/usr/sbin</xhtml:li>
            <xhtml:li>/usr/local/bin</xhtml:li>
            <xhtml:li>/usr/local/sbin</xhtml:li>
            <xhtml:li>/usr/lib64/qt-3.3/bin</xhtml:li>
            <xhtml:li>/usr/java/j2re1.4.2_06/bin</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="https://www.pcisecuritystandards.org">PCIDSS-A.1.2.c</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /bin -type f ! -user root -exec chown root {} \;
        find /sbin -type f ! -user root -exec chown root {} \;
        find /usr/bin -type f ! -user root -exec chown root {} \;
        find /usr/sbin -type f ! -user root -exec chown root {} \;
        find /usr/local/bin -type f ! -user root -exec chown root {} \;
        find /usr/local/sbin -type f ! -user root -exec chown root {} \;
        find /usr/lib64/qt-3.3/bin -type f ! -user root -exec chown root {} \;
        find /usr/java/j2re1.4.2_06/bin -type f ! -user root -exec chown root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="PCIDSS_A_1_2_c_00.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_dirs_owner" selected="true">
      <title>system command dirs owner</title>
      <description>
        <xhtml:p>System command directories must be owned by a system account.</xhtml:p>
        <xhtml:p>Restricting permissions will protect the files from unauthorized modification.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/bin</xhtml:li>
            <xhtml:li>/sbin</xhtml:li>
            <xhtml:li>/usr/bin</xhtml:li>
            <xhtml:li>/usr/sbin</xhtml:li>
            <xhtml:li>/usr/local/bin</xhtml:li>
            <xhtml:li>/usr/local/sbin</xhtml:li>
            <xhtml:li>/usr/lib64/qt-3.3/bin</xhtml:li>
            <xhtml:li>/usr/java/j2re1.4.2_06/bin</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001220</ident>
      <ident system="https://www.pcisecuritystandards.org">PCIDSS-A.1.2.c</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /bin -type d \( ! -user root \) -exec chown root {} \;
        find /sbin -type d \( ! -user root \) -exec chown root {} \;
        find /usr/bin -type d \( ! -user root \) -exec chown root {} \;
        find /usr/sbin -type d \( ! -user root \) -exec chown root {} \;
        find /usr/local/bin -type d \( ! -user root \) -exec chown root {} \;
        find /usr/local/sbin -type d \( ! -user root \) -exec chown root {} \;
        find /usr/lib64/qt-3.3/bin -type d \( ! -user root \) -exec chown root {} \;
        find /usr/java/j2re1.4.2_06/bin -type d \( ! -user root \) -exec chown root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001220.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_command_dirs_group" selected="true">
      <title>system command dirs group</title>
      <description>
        <xhtml:p>System command dirs must be owned by a system group.</xhtml:p>
        <xhtml:p>Restricting permissions will protect the files from unauthorized modification.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/bin</xhtml:li>
            <xhtml:li>/sbin</xhtml:li>
            <xhtml:li>/usr/bin</xhtml:li>
            <xhtml:li>/usr/sbin</xhtml:li>
            <xhtml:li>/usr/local/bin</xhtml:li>
            <xhtml:li>/usr/local/sbin</xhtml:li>
            <xhtml:li>/usr/lib64/qt-3.3/bin</xhtml:li>
            <xhtml:li>/usr/java/j2re1.4.2_06/bin</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001240</ident>
      <ident system="https://www.pcisecuritystandards.org">PCIDSS-A.1.2.c</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /bin -type d \( ! -group root \) -exec chgrp root {} \;
        find /sbin -type d \( ! -group root \) -exec chgrp root {} \;
        find /usr/bin -type d \( ! -group root \) -exec chgrp root {} \;
        find /usr/sbin -type d \( ! -group root \) -exec chgrp root {} \;
        find /usr/local/bin -type d \( ! -group root \) -exec chgrp root {} \;
        find /usr/local/sbin -type d \( ! -group root \) -exec chgrp root {} \;
        find /usr/lib64/qt-3.3/bin -type d \( ! -group root \) -exec chgrp root {} \;
        find /usr/java/j2re1.4.2_06/bin -type d \( ! -group root \) -exec chgrp root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001240.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-system_logs_permissions" selected="true">
      <title>syslog logs permissions</title>
      <description>
        <xhtml:p>syslog logs (all files in /var/log) should be 0640 or less.</xhtml:p>
        <xhtml:p>If the system log files are not protected, unauthorized users could change the logged data, eliminating its forensic value.</xhtml:p>
        <xhtml:p>You can optionally allow world readable log files using a variable. The desired mode would be 644 in that case.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/var/log/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001260</ident>
      <fix system="urn:xccdf:fix:script:sh">
        PERM_MASK=137
        CHMOD_MODE=u-x,g-wx,o-rwx
        # allowing world readable logs isn't part of the STIG recommendation!
        # nonetheless, it is common on desktops so we optionally allow this here
        if [ "$XCCDF_VALUE_ALLOW_WORLD_READABLE" == "1" ]; then
            PERM_MASK=133
            CHMOD_MODE=u-x,g-wx,o-wx
        fi

        find /var/log -type f -perm /0${PERM_MASK} \( ! -name 'wtmp' -a ! -name 'lastlog' \) \
          -exec chmod ${CHMOD_MODE} {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-export value-id="xccdf_org.open-scap.sce-community-content_value_system_file_permissions-system_logs_permissions-allow_world_readable" export-name="ALLOW_WORLD_READABLE"/>
        <check-content-ref href="GEN001260.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-man_pages_permissions" selected="true">
      <title>man pages permissions</title>
      <description>
        <xhtml:p>man pages must be 0644 or less.</xhtml:p>
        <xhtml:p>If manual pages are compromised, misleading information could be inserted, causing actions that may compromise the system.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/usr/share/man/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001280</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /usr/share/man -type f -perm /0133 -exec chmod u-x,g-wx,o-wx {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001280.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-library_files_permissions" selected="true">
      <title>library files permissions</title>
      <description>
        <xhtml:p>Library files must be 0755 or less.</xhtml:p>
        <xhtml:p>Unauthorized access could destroy the integrity of the library files.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/lib</xhtml:li>
            <xhtml:li>/lib64</xhtml:li>
            <xhtml:li>/usr/lib</xhtml:li>
            <xhtml:li>/usr/lib64</xhtml:li>
            <xhtml:li>/usr/local/lib</xhtml:li>
            <xhtml:li>/usr/local/lib64</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001300</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /lib -type f -perm /0022 -exec chmod go-w {} \;
        find /lib64 -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/lib -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/lib64 -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/local/lib -type f -perm /0022 -exec chmod go-w {} \;
        find /usr/local/lib64 -type f -perm /0022 -exec chmod go-w {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001300.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-passwd_file_permissions" selected="true">
      <title>password file permissions</title>
      <description>
        <xhtml:p>/etc/passwd must be 0644 or less.</xhtml:p>
        <xhtml:p>If the passwd file is writable by a group-owner or the world, the risk of passwd file compromise is increased. The passwd file contains the list of accounts on the system and associated information.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/passwd</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001380</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chmod u-x,go-wx /etc/passwd
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001380.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-shadow_file_owner" selected="true">
      <title>shadow file owner</title>
      <description>
        <xhtml:p>/etc/shadow must be owned by root.</xhtml:p>
        <xhtml:p>The /etc/shadow file contains the list of local system accounts. It is vital to system security and must be protected from unauthorized modification. Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/shadow</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001400</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chown root /etc/shadow
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001400.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-shadow_file_permissions" selected="true">
      <title>shadow file permissions</title>
      <description>
        <xhtml:p>/etc/shadow must be 0400 or less.</xhtml:p>
        <xhtml:p>The /etc/shadow file contains the list of local system accounts. It is vital to system security and must be protected from unauthorized modification. The file also contains password hashes which must not be accessible to users other than root.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/shadow</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001420</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chmod u-wx,go-rwx /etc/shadow
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001420.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-home_dirs_permissions" selected="true">
      <title>home dirs permissisions</title>
      <description>
        <xhtml:p>All home dirs must be 0750 or less.</xhtml:p>
        <xhtml:p>Excessive permissions on home directories allow unauthorized access to user files.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/home/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001480</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /home -mindepth 1 -maxdepth 1 -type d -perm /0027 -exec chmod g-w,o-rwx {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001480.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-home_dirs_files_permissions" selected="true">
      <title>home dirs files permissions</title>
      <description>
        <xhtml:p>All files in home dirs must be 0750 or less.</xhtml:p>
        <xhtml:p>Excessive permissions allow unauthorized access to user files.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/home/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001560</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /home -mindepth 2 \( -type d -o -type f \) -perm /0022 -exec chmod g-w,o-rwx {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001560.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-etc_rc_permissions" selected="true">
      <title>/etc/rc files permissions</title>
      <description>
        <xhtml:p>All /etc/rc files must be 0755 or less.</xhtml:p>
        <xhtml:p>If the startup files are writable by other users, they could modify the startup files to insert malicious commands into the startup files.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/rc*</xhtml:li>
            <xhtml:li>/etc/init.d/*</xhtml:li>
            <xhtml:li>/etc/init</xhtml:li>
            <xhtml:li>/etc/systemd</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001580</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /etc/rc* -type f -perm /0022 -exec chmod go-w {} \;
        find /etc/init.d -type f -perm /0022 -exec chmod go-w {} \;

        # Add checks for upstart and systemd respectively
        if [ -d /etc/init ] ; then
          find /etc/init -type f -perm /0022 -exec chmod go-w {} \;
        elif [ -d /etc/systemd ] ; then
          find /etc/systemd -type f -perm /0022 -exec chmod go-w {} \;
        fi
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001580.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-skeleton_files_permissions" selected="true">
      <title>skeleton files permissions</title>
      <description>
        <xhtml:p>Skeleton /etc/skel/* files must be 0644 or less.</xhtml:p>
        <xhtml:p>If the system log files are not protected, unauthorized users could change the logged data, eliminating its forensic value.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/home/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001800</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /etc/skel -type f -perm /0133 -exec chmod u-x,og-wx {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001800.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-etc_shell_files_owner" selected="true">
      <title>/etc shell files owner</title>
      <description>
        <xhtml:p>All shell files in /etc must be owned by root.</xhtml:p>
        <xhtml:p>Local initialization files are used to configure the user's shell environment upon login. Malicious modification of these files could compromise accounts upon logon.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/*</xhtml:li>
            <xhtml:li>/etc/profile.d/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001860</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /etc -maxdepth 1 -type f \( ! -user root \) -name bashrc -exec chown root {} \;
        find /etc -maxdepth 1 -type f \( ! -user root \) -name profile -exec chown root {} \;
        find /etc/profile.d/ -type f \( ! -user root \) -exec chown root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001860.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-etc_shell_files_permissions" selected="true">
      <title>/etc shell files permissions</title>
      <description>
        <xhtml:p>All shell files in /etc must be 0755 or less (???).</xhtml:p>
        <xhtml:p>Local initialization files are used to configure the user's shell environment upon login. Malicious modification of these files could compromise accounts upon logon.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/*</xhtml:li>
            <xhtml:li>/etc/profile.d/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN001880</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /etc -maxdepth 1 -type f -perm /0022 -name bashrc -exec chmod go-w {} \;
        find /etc -maxdepth 1 -type f -perm /0022 -name profile -exec chmod go-w {} \;
        find /etc/profile.d/ -type f -perm /0022 -exec chmod go-w {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN001880.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-world_writable_dirs_sticky" selected="true">
      <title>world writable dirs sticky bit</title>
      <description>
        <xhtml:p>Sticky bit must be on all world writable dirs.</xhtml:p>
        <xhtml:p>Failing to set the sticky bit on the public directories allows unauthorized users to delete files in the directory structure. The only authorized public directories are those temporary directories supplied with the system or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system and by users for temporary file storage (e.g., /tmp) and for directories that require global read/write access.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/* (all directories)</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN002500</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find / -path /proc -prune -o -type d \( -perm -0002 -a ! -perm -1000 \) -exec chmod +t {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN002500.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-world_writable_dirs_owner" selected="true">
      <title>world writable dirs owner</title>
      <description>
        <xhtml:p>All world writable dirs must be owned by system account.</xhtml:p>
        <xhtml:p>If a public directory has the sticky bit set and is not owned by a privileged UID, unauthorized users may be able to modify files created by others. The only authorized public directories are those temporary directories supplied with the system or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system and by users for temporary file storage (e.g., /tmp) and for directories that require global read/write access.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/* (all directories)</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN002520</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find / -path /proc -prune -o -type d \( -perm -0002 -a ! \( -user root -o -user gdm \) \) \
          -exec chown root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN002520.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-audit_logs_owner" selected="true">
      <title>audit logs owner</title>
      <description>
        <xhtml:p>All audit logs must be owned by root.</xhtml:p>
        <xhtml:p>Failure to give ownership of system audit log files to root provides the designated owner and unauthorized users with the potential to access sensitive information.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/var/log/audit/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN002680</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /var/log/audit -type f \( ! -user root \) -exec chown root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN002680.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-audit_logs_permissions" selected="true">
      <title>audit logs permissions</title>
      <description>
        <xhtml:p>All audit logs must be 0640 or less.</xhtml:p>
        <xhtml:p>If a user can write to the audit logs, audit trails can be modified or destroyed and system intrusion may not be detected. System audit logs are those files generated from the audit system and do not include activity, error, or other log files created by application software.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/var/log/audit/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN002700</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /var/log/audit -type f -perm /0137 -exec chmod u-x,g-wx,o-rwx {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN002700.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-cron_allow_permissions" selected="true">
      <title>cron.allow permissions</title>
      <description>
        <xhtml:p>cron.allow must be 0600 or less.</xhtml:p>
        <xhtml:p>A cron.allow file that is readable and/or writable by other than root could allow potential intruders and malicious users to use the file contents to help discern information, such as who is allowed to execute cron programs, which could be harmful to overall system and network security.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/cron.allow</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN002980</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chmod u-x,go-rwx /etc/cron.allow
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN002980.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-crontab_files_permissions" selected="true">
      <title>crontab files permissions</title>
      <description>
        <xhtml:p>crontab files must be 0600 or less. cron script must be 0700 or less.</xhtml:p>
        <xhtml:p>To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/crontab</xhtml:li>
            <xhtml:li>/etc/cron.d/*</xhtml:li>
            <xhtml:li>/etc/cron.daily/*</xhtml:li>
            <xhtml:li>/etc/cron.hourly/*</xhtml:li>
            <xhtml:li>/etc/cron.weekly/*</xhtml:li>
            <xhtml:li>/var/spool/cron/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN003080</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chmod u-x,go-rwx /etc/crontab
        find /etc/cron.d -type f -perm /0077 -exec chmod go-rwx {} \;
        find /etc/cron.daily -type f -perm /0077 -exec chmod go-rwx {} \;
        find /etc/cron.hourly -type f -perm /0077 -exec chmod go-rwx {} \;
        find /etc/cron.weekly -type f -perm /0077 -exec chmod go-rwx {} \;
        find /var/spool/cron/ -type f -perm /0077 -exec chmod go-rwx {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN003080.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-crontab_files_owners" selected="true">
      <title>crontab files owners</title>
      <description>
        <xhtml:p>crontab files and scripts must be owned by root</xhtml:p>
        <xhtml:p>To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/crontab</xhtml:li>
            <xhtml:li>/etc/cron.d/*</xhtml:li>
            <xhtml:li>/etc/cron.daily/*</xhtml:li>
            <xhtml:li>/etc/cron.hourly/*</xhtml:li>
            <xhtml:li>/etc/cron.weekly/*</xhtml:li>
            <xhtml:li>/var/spool/cron/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <fix system="urn:xccdf:fix:script:sh">
        chown root /etc/crontab
        find /etc/cron.d -type f ! -user root -exec chown root {} \;
        find /etc/cron.daily -type f ! -user root -exec chown root {} \;
        find /etc/cron.hourly -type f ! -user root -exec chown root {} \;
        find /etc/cron.weekly -type f ! -user root -exec chown root {} \;
        find /var/spool/cron/ -type f ! -user root -exec chown root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="09_crontab_owners.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-crontab_files_groups" selected="true">
      <title>crontab files owners</title>
      <description>
        <xhtml:p>crontab files and scripts must be group-owned by root</xhtml:p>
        <xhtml:p>To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/crontab</xhtml:li>
            <xhtml:li>/etc/cron.d/*</xhtml:li>
            <xhtml:li>/etc/cron.daily/*</xhtml:li>
            <xhtml:li>/etc/cron.hourly/*</xhtml:li>
            <xhtml:li>/etc/cron.weekly/*</xhtml:li>
            <xhtml:li>/var/spool/cron/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <fix system="urn:xccdf:fix:script:sh">
        chgrp root /etc/crontab
        find /etc/cron.d -type f ! -group root -exec chgrp root {} \;
        find /etc/cron.daily -type f ! -group root -exec chgrp root {} \;
        find /etc/cron.hourly -type f ! -group root -exec chgrp root {} \;
        find /etc/cron.weekly -type f ! -group root -exec chgrp root {} \;
        find /var/spool/cron/ -type f ! -group root -exec chgrp root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="10_crontab_groups.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-cron_dirs_permissions" selected="true">
      <title>cron dirs permissions</title>
      <description>
        <xhtml:p>cron directories must be 0755 or more less.</xhtml:p>
        <xhtml:p>To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/cron.d/*</xhtml:li>
            <xhtml:li>/etc/cron.daily/*</xhtml:li>
            <xhtml:li>/etc/cron.hourly/*</xhtml:li>
            <xhtml:li>/etc/cron.weekly/*</xhtml:li>
            <xhtml:li>/var/spool/cron/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN003100</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /etc/cron.d -type d -perm /0022 -exec chmod go-w {} \;
        find /etc/cron.daily -type d -perm /0022 -exec chmod go-w {} \;
        find /etc/cron.hourly -type d -perm /0022 -exec chmod go-w {} \;
        find /etc/cron.weekly -type d -perm /0022 -exec chmod go-w {} \;
        find /var/spool/cron -type d -perm /0022 -exec chmod go-w {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN003100.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-cron_dirs_owner" selected="true">
      <title>cron dirs owner</title>
      <description>
        <xhtml:p>cron directories must be owned by root.</xhtml:p>
        <xhtml:p>Incorrect ownership of the cron or crontab directories could permit unauthorized users the ability to alter cron jobs and run automated jobs as privileged users. Failure to give ownership of cron or crontab directories to root or to bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/cron.d/*</xhtml:li>
            <xhtml:li>/etc/cron.daily/*</xhtml:li>
            <xhtml:li>/etc/cron.hourly/*</xhtml:li>
            <xhtml:li>/etc/cron.weekly/*</xhtml:li>
            <xhtml:li>/var/spool/cron/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN003120</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /etc/cron.d -type d \( ! -user root \) -exec chown root {} \;
        find /etc/cron.daily -type d \( ! -user root \) -exec chown root {} \;
        find /etc/cron.hourly -type d \( ! -user root \) -exec chown root {} \;
        find /etc/cron.weekly -type d \( ! -user root \) -exec chown root {} \;
        find /var/spool/cron -type d \( ! -user root \) -exec chown root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN003120.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-cron_dirs_group" selected="true">
      <title>cron dirs group</title>
      <description>
        <xhtml:p>cron directories must be group root.</xhtml:p>
        <xhtml:p>To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured. Failure to give group-ownership of cron or crontab directories to a system group provides the designated group and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/cron.d/*</xhtml:li>
            <xhtml:li>/etc/cron.daily/*</xhtml:li>
            <xhtml:li>/etc/cron.hourly/*</xhtml:li>
            <xhtml:li>/etc/cron.weekly/*</xhtml:li>
            <xhtml:li>/var/spool/cron/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN003140</ident>
      <fix system="urn:xccdf:fix:script:sh">
        find /etc/cron.d -type d \( ! -user root \) -exec chgrp root {} \;
        find /etc/cron.daily -type d \( ! -user root \) -exec chgrp root {} \;
        find /etc/cron.hourly -type d \( ! -user root \) -exec chgrp root {} \;
        find /etc/cron.weekly -type d \( ! -user root \) -exec chgrp root {} \;
        find /var/spool/cron -type d \( ! -user root \) -exec chgrp root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN003140.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-xinetd_dirs_owner" selected="true">
      <title>xinetd dirs owner</title>
      <description>
        <xhtml:p>All xinetd directories must be owned by root.</xhtml:p>
        <xhtml:p>Failure to give ownership of sensitive files or utilities to root provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/xinetd.conf</xhtml:li>
            <xhtml:li>/etc/xinetd.d/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN003720</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chown root /etc/xinetd.conf
        find /etc/xinetd.d/ -type f \( ! -user root \) -exec chown root {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN003720.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-xinetd_files_permissions" selected="true">
      <title>xinetd files permissions</title>
      <description>
        <xhtml:p>All xinetd files must be 0640 or less.</xhtml:p>
        <xhtml:p>The Internet service daemon configuration files must be protected as malicious modification could cause denial of service or increase the attack surface of the system.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/xinetd.conf</xhtml:li>
            <xhtml:li>/etc/xinetd.d/*</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN003740</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chmod u-x,g-wx,o-rwx /etc/xinetd.conf
        find /etc/xinetd.d/ -type f -perm /0137 -exec chmod u-x,g-wx,o-rwx {} \;
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN003740.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-services_file_owner" selected="true">
      <title>services file owner</title>
      <description>
        <xhtml:p>Services file must be owned by root.</xhtml:p>
        <xhtml:p>Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/services</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN003760</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chown root /etc/services
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN003760.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-services_file_permissions" selected="true">
      <title>services file permissions</title>
      <description>
        <xhtml:p>Services file must be 0644 or less.</xhtml:p>
        <xhtml:p>The services file is critical to the proper operation of network services and must be protected from unauthorized modification. Unauthorized modification could result in the failure of network services.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/services</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN003780</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chmod u-x,go-wx /etc/services
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN003780.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-alias_file_owner" selected="true">
      <title>alias file owner</title>
      <description>
        <xhtml:p>The alias file must be owned by root.</xhtml:p>
        <xhtml:p>If the alias file is not owned by root, an unauthorized user may modify the file to add aliases to run malicious code or redirect e-mail.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/alias</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN004360</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chown root /etc/alias
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN004360.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-alias_file_permissions" selected="true">
      <title>alias file permissions</title>
      <description>
        <xhtml:p>The alias file must be 644 or less.</xhtml:p>
        <xhtml:p>Excessive permissions on the aliases file may permit unauthorized modification. If the alias file is modified by an unauthorized user, they may modify the file to run malicious code or redirect e-mail.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/alias</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN004380</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chmod u-x,go-wx /etc/alias
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN004380.sh"/>
      </check>
    </Rule>
    <Rule id="xccdf_org.open-scap.sce-community-content_rule_system_file_permissions-smb_conf_permissions" selected="true">
      <title>smb.conf permissions</title>
      <description>
        <xhtml:p>smb.conf must be 0644 or less.</xhtml:p>
        <xhtml:p>If the smb.conf file has excessive permissions, the file may be maliciously modified and the Samba configuration could be compromised.</xhtml:p>
        <xhtml:p>
          File(s) affected:
          <xhtml:ul>
            <xhtml:li>/etc/samba/smb.conf</xhtml:li>
          </xhtml:ul>
        </xhtml:p>
      </description>
      <ident system="http://iase.disa.mil/stigs">GEN006140</ident>
      <fix system="urn:xccdf:fix:script:sh">
        chmod u-x,go-wx /etc/samba/smb.conf
      </fix>
      <check system="http://open-scap.org/page/SCE">
        <check-import import-name="stdout"/>
        <check-content-ref href="GEN006140.sh"/>
      </check>
    </Rule>
  </Group>
</xf:xccdf-fragment>
